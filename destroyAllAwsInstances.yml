---
- name: Gather EC2 facts
  hosts: "{{ ec2_hosts }}"
  gather_facts: false

  vars:
    ec2_region: us-west-2
    ec2_hosts: tag_Name_dsilva_demo

  tasks:
  - name: Gather EC2 facts
    ec2_facts:

- name: Terminate EC2 hosts
  hosts: "{{ ec2_hosts }}"
  gather_facts: false
  connection: local

  vars:
    ec2_hosts: tag_Name_dsilva_demo
    ec2_region: us-west-2

  tasks:
  - name: Terminate EC2 hosts
    ec2:
      region: "{{ ec2_region }}"
      instance_ids: "{{ item }}"
      state: absent
      wait: True
    with_items: hostvars[inventory_hostname]['ansible_ec2_instance_id']
